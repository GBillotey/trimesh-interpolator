
This code has now been improved and merged into matplotlib.

Refer to https://github.com/matplotlib/matplotlib/issues/1521
